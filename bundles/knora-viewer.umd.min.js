!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@knora/core"),require("@angular/common"),require("@angular/forms"),require("@angular/material"),require("@angular/material/datepicker"),require("@knora/action")):"function"==typeof define&&define.amd?define("@knora/viewer",["exports","@angular/core","@knora/core","@angular/common","@angular/forms","@angular/material","@angular/material/datepicker","@knora/action"],t):t((e.knora=e.knora||{},e.knora.viewer={}),e.ng.core,null,e.ng.common,e.ng.forms,e.ng.material,e.ng.material.datepicker,null)}(this,function(e,t,p,n,o,r,a,i){"use strict";var s=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-annotation",template:"<p>\n  annotation works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),l=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-audio",template:"<p>\n  audio works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),u=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-collection",template:"<p>\n  collection works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),c=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-ddd",template:"<p>\n  ddd works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),m=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-document",template:"<p>\n  document works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),g=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-link-obj",template:"<p>\n  link-obj works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),f=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-moving-image",template:"<p>\n  moving-image works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),d=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-object",template:"<p>\n  object works!\n</p>",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),h=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-region",template:"<p>\n  region works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}();function v(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}var y=function(){function e(e){this.regionResource=e}return e.prototype.getGeometries=function(){return this.regionResource.properties[p.KnoraConstants.hasGeometry]},e}(),b=function Z(e,t){this.stillImageFileValue=e,this.regions=t},O=function Y(e,t){this.offsetChange=e,this.whenLoadedCB=t},w=function W(e,t){this.geometry=e,this.region=t},x=function(){function m(e){this.elementRef=e,this.getImages=new t.EventEmitter,this.regionHovered=new t.EventEmitter,this.pagingLimit=25}return m.surfaceOfRectangularRegion=function(e){return"rectangle"!==e.type?(console.log("expected rectangular region, but "+e.type+" given"),0):(Math.max(e.points[0].x,e.points[1].x)-Math.min(e.points[0].x,e.points[1].x))*(Math.max(e.points[0].y,e.points[1].y)-Math.min(e.points[0].y,e.points[1].y))},m.prepareTileSourcesFromFileValues=function(e){var t,n,o=0,r=[];try{for(var a=v(e),i=a.next();!i.done;i=a.next()){var s=i.value,l=s.imageServerIIIFBaseURL+"/"+s.imageFilename,u=s.dimX,c=s.dimY;r.push({tileSource:{"@context":"http://iiif.io/api/image/2/context.json","@id":l,height:c,width:u,profile:["http://iiif.io/api/image/2/level2.json"],protocol:"http://iiif.io/api/image",tiles:[{scaleFactors:[1,2,4,8,16,32],width:1024}]},x:o,y:0}),o++}}catch(p){t={error:p}}finally{try{i&&!i.done&&(n=a["return"])&&n.call(a)}finally{if(t)throw t.error}}return r},m.prototype.ngOnChanges=function(e){e.images&&e.images.isFirstChange()&&this.setupViewer(),e.images&&(this.openImages(),this.renderRegions())},m.prototype.ngOnInit=function(){},m.prototype.ngOnDestroy=function(){this.viewer&&(this.viewer.destroy(),this.viewer=undefined)},m.prototype.updateImages=function(){this.viewer||this.setupViewer(),this.openImages()},m.prototype.gotoLeft=function(){0<=this.imageRangeStart-this.imageChangeInterval?(this.imageRangeStart-=this.imageChangeInterval,this.imageRangeEnd-=this.imageChangeInterval,this.openImages(),this.renderRegions()):0<this.imageRangeStart&&(this.imageRangeEnd-=this.imageRangeStart,this.imageRangeStart=0,this.openImages(),this.renderRegions())},m.prototype.gotoRight=function(){var n=this;if(this.imageRangeEnd<this.images.length-1){if(this.imageRangeEnd+this.imageChangeInterval<this.images.length)console.log("display next interval"),this.imageRangeStart+=this.imageChangeInterval,this.imageRangeEnd+=this.imageChangeInterval;else{console.log("display remaining images");var e=this.images.length-this.imageRangeEnd+1;this.imageRangeStart+=e,this.imageRangeEnd+=e}this.openImages(),this.renderRegions()}else if(this.images.length%this.pagingLimit==0){console.log("request more images");var t=new O(1,function(e){if(e>=n.imageChangeInterval)n.imageRangeStart+=n.imageChangeInterval,n.imageRangeEnd+=n.imageChangeInterval,n.openImages(),n.renderRegions();else if(0<e)n.imageRangeStart+=e,n.imageRangeEnd+=e,n.openImages(),n.renderRegions();else{var t=n.images.length-1-n.imageRangeEnd;n.imageRangeStart+=t,n.imageRangeEnd+=t,n.openImages(),n.renderRegions()}});this.getImages.emit(t)}},m.prototype.updateRegions=function(){this.viewer||this.setupViewer(),this.renderRegions()},m.prototype.setupViewer=function(){var t=this.elementRef.nativeElement.getElementsByClassName("osd-container")[0],e={element:t,sequenceMode:!0,showReferenceStrip:!0,showNavigator:!0,zoomInButton:"KUI_OSD_ZOOM_IN",zoomOutButton:"KUI_OSD_ZOOM_OUT",previousButton:"KUI_OSD_PREV_PAGE",nextButton:"KUI_OSD_NEXT_PAGE",homeButton:"KUI_OSD_HOME",fullPageButton:"KUI_OSD_FULL_PAGE",rotateLeftButton:"KUI_OSD_ROTATE_LEFT",rotateRightButton:"KUI_OSD_ROTATE_RIGHT"};this.viewer=new OpenSeadragon.Viewer(e),this.viewer.addHandler("full-screen",function(e){e.fullScreen?t.classList.add("fullscreen"):t.classList.remove("fullscreen")}),this.viewer.addHandler("resize",function(e){e.eventSource.svgOverlay().resize()})},m.prototype.openImages=function(){var e=this.images.map(function(e){return e.stillImageFileValue}),t=m.prepareTileSourcesFromFileValues(e.slice(this.imageRangeStart,this.imageRangeEnd+1));this.viewer.clearOverlays(),this.viewer.open(t)},m.prototype.renderRegions=function(){this.viewer.clearOverlays();var e,t,c=0,n=function(e){var t,n,o=e.stillImageFileValue.dimY/e.stillImageFileValue.dimX,r=[];e.regions.map(function(n){n.getGeometries().map(function(e){var t=new w(e.geometry,n.regionResource);r.push(t)})}),r.sort(function(e,t){return"rectangle"!==e.geometry.type||"rectangle"!==t.geometry.type?0:m.surfaceOfRectangularRegion(e.geometry)<m.surfaceOfRectangularRegion(t.geometry)?1:-1});try{for(var a=v(r),i=a.next();!i.done;i=a.next()){var s=i.value,l=s.geometry;p.createSVGOverlay(s.region.id,l,o,c,s.region.label)}}catch(u){t={error:u}}finally{try{i&&!i.done&&(n=a["return"])&&n.call(a)}finally{if(t)throw t.error}}c++},p=this;try{for(var o=v(this.images),r=o.next();!r.done;r=o.next()){n(r.value)}}catch(a){e={error:a}}finally{try{r&&!r.done&&(t=o["return"])&&t.call(o)}finally{if(e)throw e.error}}},m.prototype.createSVGOverlay=function(e,t,n,o,r){var a,i=this,s=t.lineColor,l=t.lineWidth;switch(t.type){case"rectangle":a=document.createElementNS("http://www.w3.org/2000/svg","polygon"),this.addSVGAttributesRectangle(a,t,n,o);break;case"polygon":a=document.createElementNS("http://www.w3.org/2000/svg","polygon"),this.addSVGAttributesPolygon(a,t,n,o);break;case"circle":a=document.createElementNS("http://www.w3.org/2000/svg","circle"),this.addSVGAttributesCircle(a,t,n,o);break;default:return void console.log("ERROR: StillImageOSDViewerComponent.createSVGOverlay: unknown geometryType: "+t.type)}a.id="roi-svgoverlay-"+1e4*Math.random(),a.setAttribute("class","roi-svgoverlay"),a.setAttribute("style","stroke: "+s+"; stroke-width: "+l+"px;"),a.addEventListener("mouseover",function(){i.regionHovered.emit(e)},!1);var u=document.createElementNS("http://www.w3.org/2000/svg","title");u.textContent=r;var c=document.createElementNS("http://www.w3.org/2000/svg","g");c.appendChild(u),c.appendChild(a),this.viewer.svgOverlay().node().appendChild(c)},m.prototype.addSVGAttributesRectangle=function(e,t,n,o){var r=t.points[0],a=t.points[1],i=new p.Point2D(Math.min(r.x,a.x),Math.min(r.y,a.y)),s=new p.Point2D(Math.max(r.x,a.x),Math.max(r.y,a.y)),l=[i,new p.Point2D(Math.max(r.x,a.x),Math.min(r.y,a.y)),s,new p.Point2D(Math.min(r.x,a.x),Math.max(r.y,a.y))],u=this.image2ViewPortCoords(l,n,o),c=this.createSVGPolygonPointsAttribute(u);e.setAttribute("points",c)},m.prototype.addSVGAttributesPolygon=function(e,t,n,o){var r=this.image2ViewPortCoords(t.points,n,o),a=this.createSVGPolygonPointsAttribute(r);e.setAttribute("points",a)},m.prototype.addSVGAttributesCircle=function(e,t,n,o){var r=this.image2ViewPortCoords(t.points,n,o),a=String(r[0].x),i=String(r[0].y),s=String(Math.sqrt(t.radius.x*t.radius.x+n*n*t.radius.y*t.radius.y));e.setAttribute("cx",a),e.setAttribute("cy",i),e.setAttribute("r",s)},m.prototype.image2ViewPortCoords=function(e,t,n){return e.map(function(e){return new p.Point2D(e.x+n,e.y*t)})},m.prototype.createSVGPolygonPointsAttribute=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t+=e[n].x,t+=",",t+=e[n].y,t+=" ");return t},m.decorators=[{type:t.Component,args:[{selector:"kui-still-image",template:'<div class="still-image-viewer">\n    <div class="navigation left">\n        <button mat-button class="full-size" id="KUI_OSD_PREV_PAGE">\n            <mat-icon>keyboard_arrow_left</mat-icon>\n        </button>\n    </div>\n\n    \x3c!-- main content with navigation and osd viewer --\x3e\n    <div class="content">\n\n        \x3c!-- header with image tools --\x3e\n        <mat-toolbar class="header">\n            <mat-toolbar-row>\n                \x3c!-- home button --\x3e\n                <span>\n                <button mat-icon-button id="KUI_OSD_HOME"><mat-icon>home</mat-icon></button>\n            </span>\n                \x3c!-- zoom buttons --\x3e\n                <span class="fill-remaining-space"></span>\n                <span>\n                <button mat-icon-button id="KUI_OSD_ZOOM_IN"><mat-icon>add</mat-icon></button>\n                <button mat-icon-button id="KUI_OSD_ZOOM_OUT"><mat-icon>remove</mat-icon></button>\n            </span>\n                \x3c!-- window button --\x3e\n                <span class="fill-remaining-space"></span>\n                <span>\n                <button mat-icon-button id="KUI_OSD_FULL_PAGE"><mat-icon>fullscreen</mat-icon></button>\n            </span>\n            </mat-toolbar-row>\n        </mat-toolbar>\n\n        \x3c!-- openseadragon (osd) viewer --\x3e\n        <div class="osd-container"></div>\n        \x3c!-- /openseadragon (osd) --\x3e\n        \x3c!-- footer for copyright info; download button etc. --\x3e\n        <div class="footer">\n            <p class="mat-caption" [innerHtml]="imageCaption"></p>\n        </div>\n\n    </div>\n\n    <div class="navigation right">\n        <button mat-button class="full-size" id="KUI_OSD_NEXT_PAGE">\n            <mat-icon>keyboard_arrow_right</mat-icon>\n        </button>\n    </div>\n\n</div>\n\n\x3c!-- simple image viewer e.g. as a preview --\x3e\n\x3c!-- TODO: handle images array --\x3e\n\x3c!--<img *ngIf="simple && images?.length === 1; else osdViewer" [src]="simpleImageExample">--\x3e\n\n\n\x3c!--\n    <div>\n        <span *ngIf="images.length > 1" (click)="gotoLeft()">&lt;&lt;</span>\n        <span *ngIf="images.length > 1" (click)="gotoRight()">&gt;&gt;</span>\n    </div>\n--\x3e\n\n\n\n',styles:[".still-image-viewer{display:inline-flex;height:400px;max-width:800px;width:100%}@media (max-height:636px){.still-image-viewer{height:300px}}.still-image-viewer .navigation{height:calc(400px + 64px + 24px);width:36px}.still-image-viewer .navigation .mat-button.full-size{height:100%!important;width:36px!important;padding:0!important;min-width:36px!important}.still-image-viewer .content{height:calc(400px + 64px + 24px);max-width:calc(800px - (2 * 36px));width:calc(100% - (2 * 36px))}.still-image-viewer .content .osd-container{color:#ccc;background-color:#000;height:400px}.still-image-viewer .content .osd-container.fullscreen{max-width:100vw}.still-image-viewer .content .footer p{color:#ccc;background-color:#000;height:24px;margin:0;padding:0 16px}/deep/ .roi-svgoverlay{opacity:.4;fill:transparent;stroke:#00695c;stroke-width:2px;vector-effect:non-scaling-stroke}.roi-svgoverlay:focus,/deep/ .roi-svgoverlay:hover{opacity:1}"]}]}],m.ctorParameters=function(){return[{type:t.ElementRef}]},m.propDecorators={images:[{type:t.Input}],imageRangeStart:[{type:t.Input}],imageRangeEnd:[{type:t.Input}],imageChangeInterval:[{type:t.Input}],imageCaption:[{type:t.Input}],getImages:[{type:t.Output}],regionHovered:[{type:t.Output}]},m}(),k=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-text",template:"<p>\n  text works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),C=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._booleanValueObj},set:function(e){this._booleanValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-boolean-value",template:'<mat-checkbox [checked]="valueObject.bool" disabled="true"></mat-checkbox>\n',styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),I=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._colorValueObj},set:function(e){this._colorValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-color-value",template:'<span [style.background-color]="valueObject.colorHex">{{valueObject.colorHex}}</span>',styles:[".fill-remaining-space{flex:1 1 auto}.mat-form-field{width:36px;overflow-x:visible}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),j=function(){function e(){}return Object.defineProperty(e.prototype,"calendar",{get:function(){return this._calendar},set:function(e){this._calendar=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"era",{get:function(){return this._era},set:function(e){this._era=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._dateValueObj},set:function(e){this._dateValueObj=e;var t=this.valueObject.getDateSalsah();t instanceof p.DateRangeSalsah?(this.period=!0,this.dates=[this.getJSDate(t.start),this.getJSDate(t.end)]):(this.period=!1,this.dates=[this.getJSDate(t)])},enumerable:!0,configurable:!0}),e.prototype.getJSDate=function(e){return e.precision===p.Precision.yearPrecision?{format:"yyyy",date:new Date(e.year.toString()),era:e.era,calendar:e.calendar}:e.precision===p.Precision.monthPrecision?{format:"MMMM yyyy",date:new Date(e.year,e.month-1,1),era:e.era,calendar:e.calendar}:e.precision===p.Precision.dayPrecision?{format:"longDate",date:new Date(e.year,e.month-1,e.day),era:e.era,calendar:e.calendar}:void console.error("Error: incorrect precision for date")},e.decorators=[{type:t.Component,args:[{selector:"kui-date-value",template:'<span *ngIf="period; else preciseDate">\n    {{dates[0].date | date: dates[0].format}}\n    <span *ngIf="era">\n        {{dates[0].era}}\n    </span>\n    - {{dates[1].date | date: dates[1].format}}\n    <span *ngIf="era">\n        {{dates[1].era}}\n    </span>\n\n    <span *ngIf="calendar">\n        ({{dates[0].calendar}})\n    </span>\n</span>\n\n<ng-template #preciseDate>\n\n    <span>\n        {{dates[0].date | date: dates[0].format }}\n        <span *ngIf="era">\n            {{dates[0].era}}\n        </span>\n        <span *ngIf="calendar">\n            ({{dates[0].calendar}})\n        </span>\n    </span>\n\n</ng-template>\n',styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={calendar:[{type:t.Input}],era:[{type:t.Input}],valueObject:[{type:t.Input}]},e}(),R=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._decimalValueObj},set:function(e){this._decimalValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-decimal-value",template:"<span>{{valueObject.decimal}}</span>",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),S=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-external-res-value",template:"<p>\n  external-res-value works!\n</p>\n",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e}(),V=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._geomValueObj},set:function(e){this._geomValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-geometry-value",template:"<span>{{valueObject.geometryString}}</span>",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),_=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-geoname-value",template:"<p>\n  geoname-value works!\n</p>",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e}(),P=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._integerValueObj},set:function(e){this._integerValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-integer-value",template:"<span>{{valueObject.integer}}</span>",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),D=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._intervalValueObj},set:function(e){this._intervalValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-interval-value",template:"<span>{{valueObject.intervalStart}} - {{valueObject.intervalEnd}}</span>",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),M=function(){function e(){this.referredResourceClicked=new t.EventEmitter}return Object.defineProperty(e.prototype,"ontologyInfo",{get:function(){return this._ontoInfo},set:function(e){this._ontoInfo=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._linkValueObj},set:function(e){this._linkValueObj=e,this.valueObject.referredResource!==undefined?this.referredResource=this.valueObject.referredResource.label:this.referredResource=this.valueObject.referredResourceIri},enumerable:!0,configurable:!0}),e.prototype.refResClicked=function(){this.referredResourceClicked.emit(this._linkValueObj)},e.decorators=[{type:t.Component,args:[{selector:"kui-link-value",template:'<a class="salsah-link" (click)="refResClicked()">{{referredResource}}</a>',styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={ontologyInfo:[{type:t.Input}],valueObject:[{type:t.Input}],referredResourceClicked:[{type:t.Output}]},e}(),E=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._listValueObj},set:function(e){this._listValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-list-value",template:"<span>{{valueObject.listNodeLabel}}</span>",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),L=function(){function e(e){this.el=e,this.referredResourceClicked=new t.EventEmitter}return Object.defineProperty(e.prototype,"ontologyInfo",{get:function(){return this._ontoInfo},set:function(e){this._ontoInfo=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bindEvents",{get:function(){return this._bindEvents},set:function(e){this._bindEvents=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._htmlValueObj},set:function(e){this._htmlValueObj=e,this.el.nativeElement.innerHTML&&(this.el.nativeElement.innerHTML=this.valueObject.html)},enumerable:!0,configurable:!0}),e.prototype.refResClicked=function(e){this.referredResourceClicked.emit(e)},e.prototype.onClick=function(e){return this._bindEvents&&"a"===e.nodeName.toLowerCase()&&0<=e.className.toLowerCase().indexOf(p.KnoraConstants.SalsahLink)&&e.href!==undefined?this.refResClicked(e.href):this.bindEvents&&"a"===e.nodeName.toLowerCase()&&e.href!==undefined&&window.open(e.href,"_blank"),!1},e.decorators=[{type:t.Component,args:[{selector:"kui-text-value-as-html",template:"<div>{{valueObject.html}}</div>",styles:[""]}]}],e.ctorParameters=function(){return[{type:t.ElementRef}]},e.propDecorators={referredResourceClicked:[{type:t.Output}],ontologyInfo:[{type:t.Input}],bindEvents:[{type:t.Input}],valueObject:[{type:t.Input}],onClick:[{type:t.HostListener,args:["click",["$event.target"]]}]},e}(),K=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._textStringValueObj},set:function(e){this._textStringValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-text-value-as-string",template:"<span>{{valueObject.str}}</span>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),A=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._xmlValueObj},set:function(e){this._xmlValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-text-value-as-xml",template:"<span>{{valueObject.xml}}</span>",styles:[""]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),T=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this._textfileValueObj},set:function(e){this._textfileValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-textfile-value",template:'<a target="_blank" href="{{valueObject.textFileURL}}">{{valueObject.textFilename}}</a>',styles:[""]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),F=function(){function e(){}return Object.defineProperty(e.prototype,"valueObject",{get:function(){return this.__uriValueObj},set:function(e){this.__uriValueObj=e},enumerable:!0,configurable:!0}),e.decorators=[{type:t.Component,args:[{selector:"kui-uri-value",template:'<a href="{{valueObject.uri}}" target="_blank">{{valueObject.uri}}</a>',styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e.propDecorators={valueObject:[{type:t.Input}]},e}(),G=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-compare-view",template:"<p>\n  compare-view works!\n</p>\n",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e}(),N=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-graph-view",template:"<p>\n  graph-view works!\n</p>\n",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e}(),U=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-grid-view",template:"<p>\n  grid-view works!\n</p>\n",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e}(),q=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-list-view",template:"<p>\n  list-view works!\n</p>\n",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e}(),H=function(){function e(){}return e.decorators=[{type:t.Component,args:[{selector:"kui-properties-view",template:"<p>\n    properties-view works!\n</p>",styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[]},e}(),B=require("jsonld"),z=function(){function e(e,t,n){this._resourceService=e,this._cacheService=t,this._incomingService=n,this.iri="http://rdfh.ch/8be1b7cf7103",this.KnoraConstants=p.KnoraConstants}return e.prototype.ngOnInit=function(){this.getResource(this.iri)},e.prototype.getResource=function(e){var o=this;this._resourceService.getResource(e).subscribe(function(e){console.log("result: ",e.body),B.promises.compact(e.body,{}).then(function(e){var t=p.ConvertJSONLD.createReadResourcesSequenceFromJsonLD(e);if(1===t.resources.length){var n=p.ConvertJSONLD.getResourceClassesFromJsonLD(e);o._cacheService.getResourceClassDefinitions(n).subscribe(function(e){o.ontologyInfo=e,o.resource=t.resources[0]},function(e){console.log("cache request failed: "+e)})}else o.errorMessage="Exactly one resource was expected, but "+t.resources.length+" resource(s) given."},function(e){console.error("JSONLD of full resource request could not be expanded:"+e)})},function(e){console.error(e)})},e.decorators=[{type:t.Component,args:[{selector:"kui-resource-view",template:'<mat-card>\n\n    \x3c!-- TODO: switch through the media type --\x3e\n    <kui-still-image></kui-still-image>\n    <kui-moving-image></kui-moving-image>\n    <kui-annotation></kui-annotation>\n    <kui-audio></kui-audio>\n    <kui-collection></kui-collection>\n    <kui-ddd></kui-ddd>\n    <kui-document></kui-document>\n    <kui-link-obj></kui-link-obj>\n    <kui-object></kui-object>\n    <kui-region></kui-region>\n    <kui-text></kui-text>\n\n    <h2>metadata for resource {{ resource?.label}} ({{ resource?.id }})</h2>\n    <h3>type: {{ontologyInfo?.getLabelForResourceClass(resource?.type)}}</h3>\n\n    <div *ngFor="let prop of resource?.properties | key">\n        <mat-list>\n            <span>{{ontologyInfo?.getLabelForProperty(prop.key)}}</span>\n            <mat-list-item *ngFor="let val of prop.value">\n                <span [ngSwitch]="val.getClassName()">\n                    <kui-color-value *ngSwitchCase="KnoraConstants.ReadColorValue" [valueObject]="val"></kui-color-value>\n                    <kui-text-value-as-html *ngSwitchCase="KnoraConstants.ReadTextValueAsHtml" [valueObject]="val" [ontologyInfo]="ontologyInfo"\n                        [bindEvents]="true"></kui-text-value-as-html>\n                    <kui-text-value-as-string *ngSwitchCase="KnoraConstants.ReadTextValueAsString" [valueObject]="val"></kui-text-value-as-string>\n                    <kui-text-value-as-xml *ngSwitchCase="KnoraConstants.ReadTextValueAsXml" [valueObject]="val"></kui-text-value-as-xml>\n                    <kui-date-value *ngSwitchCase="KnoraConstants.ReadDateValue" [valueObject]="val"></kui-date-value>\n                    <kui-link-value *ngSwitchCase="KnoraConstants.ReadLinkValue" [valueObject]="val" [ontologyInfo]="ontologyInfo"></kui-link-value>\n                    <kui-integer-value *ngSwitchCase="KnoraConstants.ReadIntegerValue" [valueObject]="val"></kui-integer-value>\n                    <kui-decimal-value *ngSwitchCase="KnoraConstants.ReadDecimalValue" [valueObject]="val"></kui-decimal-value>\n                    <kui-geometry-value *ngSwitchCase="KnoraConstants.ReadGeomValue" [valueObject]="val"></kui-geometry-value>\n                    <kui-uri-value *ngSwitchCase="KnoraConstants.ReadUriValue" [valueObject]="val"></kui-uri-value>\n                    <kui-boolean-value *ngSwitchCase="KnoraConstants.ReadBooleanValue" [valueObject]="val"></kui-boolean-value>\n                    <kui-interval-value *ngSwitchCase="KnoraConstants.ReadIntervalValue" [valueObject]="val"></kui-interval-value>\n                    <kui-list-value *ngSwitchCase="KnoraConstants.ReadListValue" [valueObject]="val"></kui-list-value>\n                    <kui-textfile-value *ngSwitchCase="KnoraConstants.TextFileValue" [valueObject]="val"></kui-textfile-value>\n                    <span *ngSwitchDefault="">Not supported {{val.getClassName()}}</span>\n                </span>\n            </mat-list-item>\n        </mat-list>\n    </div>\n\n</mat-card>\n',styles:[".mat-form-field{width:320px}.fill-remaining-space{flex:1 1 auto}"]}]}],e.ctorParameters=function(){return[{type:p.ResourceService},{type:p.OntologyCacheService},{type:p.IncomingService}]},e.propDecorators={iri:[{type:t.Input}]},e}(),J=function(){function e(){}return e.prototype.ngOnInit=function(){},e.decorators=[{type:t.Component,args:[{selector:"kui-table-view",template:"<p>\n  table-view works!\n</p>\n",styles:[""]}]}],e.ctorParameters=function(){return[]},e}(),X=function(){function e(){}return e.decorators=[{type:t.NgModule,args:[{imports:[n.CommonModule,p.KuiCoreModule,i.KuiActionModule,r.MatAutocompleteModule,r.MatButtonModule,r.MatCardModule,r.MatCheckboxModule,a.MatDatepickerModule,r.MatFormFieldModule,r.MatInputModule,r.MatIconModule,r.MatListModule,r.MatNativeDateModule,r.MatSlideToggleModule,r.MatToolbarModule,r.MatTooltipModule,o.ReactiveFormsModule],declarations:[s,l,u,c,m,g,f,d,h,x,k,L,K,A,T,j,P,I,R,F,C,V,_,D,E,M,S,q,U,J,z,G,N,H],exports:[s,l,u,c,m,g,f,d,h,x,k,L,K,A,T,j,P,I,R,F,C,V,_,D,E,M,S,q,U,J,z,G,N,H]}]}],e}();e.AnnotationComponent=s,e.AudioComponent=l,e.CollectionComponent=u,e.DddComponent=c,e.DocumentComponent=m,e.LinkObjComponent=g,e.MovingImageComponent=f,e.ObjectComponent=d,e.RegionComponent=h,e.ImageRegion=y,e.StillImageRepresentation=b,e.RequestStillImageRepresentations=O,e.GeometryForRegion=w,e.StillImageComponent=x,e.TextComponent=k,e.BooleanValueComponent=C,e.ColorValueComponent=I,e.DateValueComponent=j,e.DecimalValueComponent=R,e.ExternalResValueComponent=S,e.GeometryValueComponent=V,e.GeonameValueComponent=_,e.IntegerValueComponent=P,e.IntervalValueComponent=D,e.LinkValueComponent=M,e.ListValueComponent=E,e.TextValueAsHtmlComponent=L,e.TextValueAsStringComponent=K,e.TextValueAsXmlComponent=A,e.TextfileValueComponent=T,e.UriValueComponent=F,e.CompareViewComponent=G,e.GraphViewComponent=N,e.GridViewComponent=U,e.ListViewComponent=q,e.PropertiesViewComponent=H,e.ResourceViewComponent=z,e.TableViewComponent=J,e.KuiViewerModule=X,e.ɵu=C,e.ɵr=I,e.ɵp=j,e.ɵs=R,e.ɵba=S,e.ɵv=V,e.ɵw=_,e.ɵq=P,e.ɵx=D,e.ɵz=M,e.ɵy=E,e.ɵl=L,e.ɵm=K,e.ɵn=A,e.ɵo=T,e.ɵt=F,e.ɵa=s,e.ɵb=l,e.ɵc=u,e.ɵd=c,e.ɵe=m,e.ɵf=g,e.ɵg=f,e.ɵh=d,e.ɵi=h,e.ɵj=x,e.ɵk=k,e.ɵbf=G,e.ɵbg=N,e.ɵbc=U,e.ɵbb=q,e.ɵbh=H,e.ɵbe=z,e.ɵbd=J,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=knora-viewer.umd.min.js.map